{"version":3,"sources":["MetisMenu.js"],"names":["define","skylark","$","TRANSITION_END","NAME","DATA_KEY","EVENT_KEY","JQUERY_NO_CONFLICT","fn","TRANSITION_DURATION","Default","toggle","preventDefault","triggerElement","parentTrigger","subMenu","Event","SHOW","SHOWN","HIDE","HIDDEN","CLICK_DATA_API","ClassName","METIS","ACTIVE","COLLAPSE","COLLAPSING","COLLAPSED","MetisMenu","[object Object]","element","config","this","transitioning","init","self","conf","el","addClass","find","children","attr","parents","has","not","on","e","eTar","paRent","parent","sibLi","siblings","sibTrigger","hasClass","removeActive","setActive","onTransitionStart","li","ul","length","show","removeClass","hide","elem","startEvent","trigger","isDefaultPrevented","toggleElem","height","setTransitioning","scrollHeight","one","emulateTransitionEnd","offsetHeight","complete","onTransitionEnd","css","isTransitioning","removeData","off","each","$this","data","undefined","Error","jQueryInterface","Constructor","noConflict","attach"],"mappings":"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","file":"../MetisMenu.js","sourcesContent":["define([\n  \"skylark-langx/skylark\",\n  \"skylark-jquery\"\n],function(skylark,$){\n  const TRANSITION_END = 'transitionend';\n \n\n  const NAME = 'metisMenu';\n  const DATA_KEY = 'metisMenu';\n  const EVENT_KEY = `.${DATA_KEY}`;\n  const DATA_API_KEY = '.data-api';\n  const JQUERY_NO_CONFLICT = $.fn[NAME];\n  const TRANSITION_DURATION = 350;\n\n  const Default = {\n    toggle: true,\n    preventDefault: true,\n    triggerElement: 'a',\n    parentTrigger: 'li',\n    subMenu: 'ul',\n  };\n\n  const Event = {\n    SHOW: `show${EVENT_KEY}`,\n    SHOWN: `shown${EVENT_KEY}`,\n    HIDE: `hide${EVENT_KEY}`,\n    HIDDEN: `hidden${EVENT_KEY}`,\n    CLICK_DATA_API: `click${EVENT_KEY}${DATA_API_KEY}`,\n  };\n\n  const ClassName = {\n    METIS: 'metismenu',\n    ACTIVE: 'mm-active',\n    SHOW: 'mm-show',\n    COLLAPSE: 'mm-collapse',\n    COLLAPSING: 'mm-collapsing',\n    COLLAPSED: 'mm-collapsed',\n  };\n\n  class MetisMenu {\n    // eslint-disable-line no-shadow\n    constructor(element, config) {\n      this.element = element;\n      this.config = {\n        ...Default,\n        ...config,\n      };\n      this.transitioning = null;\n\n      this.init();\n    }\n\n    init() {\n      const self = this;\n      const conf = this.config;\n      const el = $(this.element);\n\n      el.addClass(ClassName.METIS); // add metismenu class to element\n\n      el.find(`${conf.parentTrigger}.${ClassName.ACTIVE}`)\n        .children(conf.triggerElement)\n        .attr('aria-expanded', 'true'); // add attribute aria-expanded=true the trigger element\n\n      el.find(`${conf.parentTrigger}.${ClassName.ACTIVE}`)\n        .parents(conf.parentTrigger)\n        .addClass(ClassName.ACTIVE);\n\n      el.find(`${conf.parentTrigger}.${ClassName.ACTIVE}`)\n        .parents(conf.parentTrigger)\n        .children(conf.triggerElement)\n        .attr('aria-expanded', 'true'); // add attribute aria-expanded=true the triggers of all parents\n\n      el.find(`${conf.parentTrigger}.${ClassName.ACTIVE}`)\n        .has(conf.subMenu)\n        .children(conf.subMenu)\n        .addClass(`${ClassName.COLLAPSE} ${ClassName.SHOW}`);\n\n      el\n        .find(conf.parentTrigger)\n        .not(`.${ClassName.ACTIVE}`)\n        .has(conf.subMenu)\n        .children(conf.subMenu)\n        .addClass(ClassName.COLLAPSE);\n\n      el\n        .find(conf.parentTrigger)\n        // .has(conf.subMenu)\n        .children(conf.triggerElement)\n        .on(Event.CLICK_DATA_API, function (e) { // eslint-disable-line func-names\n          const eTar = $(this);\n\n          if (eTar.attr('aria-disabled') === 'true') {\n            return;\n          }\n\n          if (conf.preventDefault && eTar.attr('href') === '#') {\n            e.preventDefault();\n          }\n\n          const paRent = eTar.parent(conf.parentTrigger);\n          const sibLi = paRent.siblings(conf.parentTrigger);\n          const sibTrigger = sibLi.children(conf.triggerElement);\n\n          if (paRent.hasClass(ClassName.ACTIVE)) {\n            eTar.attr('aria-expanded', 'false');\n            self.removeActive(paRent);\n          } else {\n            eTar.attr('aria-expanded', 'true');\n            self.setActive(paRent);\n            if (conf.toggle) {\n              self.removeActive(sibLi);\n              sibTrigger.attr('aria-expanded', 'false');\n            }\n          }\n\n          if (conf.onTransitionStart) {\n            conf.onTransitionStart(e);\n          }\n        });\n    }\n\n    setActive(li) {\n      $(li).addClass(ClassName.ACTIVE);\n      const ul = $(li).children(this.config.subMenu);\n      if (ul.length > 0 && !ul.hasClass(ClassName.SHOW)) {\n        this.show(ul);\n      }\n    }\n\n    removeActive(li) {\n      $(li).removeClass(ClassName.ACTIVE);\n      const ul = $(li).children(`${this.config.subMenu}.${ClassName.SHOW}`);\n      if (ul.length > 0) {\n        this.hide(ul);\n      }\n    }\n\n    show(element) {\n      if (this.transitioning || $(element).hasClass(ClassName.COLLAPSING)) {\n        return;\n      }\n      const elem = $(element);\n\n      const startEvent = $.Event(Event.SHOW);\n      elem.trigger(startEvent);\n\n      if (startEvent.isDefaultPrevented()) {\n        return;\n      }\n\n      elem.parent(this.config.parentTrigger).addClass(ClassName.ACTIVE);\n\n      if (this.config.toggle) {\n        const toggleElem = elem.parent(this.config.parentTrigger).siblings().children(`${this.config.subMenu}.${ClassName.SHOW}`);\n        this.hide(toggleElem);\n      }\n\n      elem\n        .removeClass(ClassName.COLLAPSE)\n        .addClass(ClassName.COLLAPSING)\n        .height(0);\n\n      this.setTransitioning(true);\n\n      const complete = () => {\n        // check if disposed\n        if (!this.config || !this.element) {\n          return;\n        }\n        elem\n          .removeClass(ClassName.COLLAPSING)\n          .addClass(`${ClassName.COLLAPSE} ${ClassName.SHOW}`)\n          .height('');\n\n        this.setTransitioning(false);\n\n        elem.trigger(Event.SHOWN);\n      };\n\n      elem\n        .height(element[0].scrollHeight)\n        .one(TRANSITION_END, complete)\n        .emulateTransitionEnd(TRANSITION_DURATION);\n    }\n\n    hide(element) {\n      if (\n        this.transitioning || !$(element).hasClass(ClassName.SHOW)\n      ) {\n        return;\n      }\n\n      const elem = $(element);\n\n      const startEvent = $.Event(Event.HIDE);\n      elem.trigger(startEvent);\n\n      if (startEvent.isDefaultPrevented()) {\n        return;\n      }\n\n      elem.parent(this.config.parentTrigger).removeClass(ClassName.ACTIVE);\n      // eslint-disable-next-line no-unused-expressions\n      elem.height(elem.height())[0].offsetHeight;\n\n      elem\n        .addClass(ClassName.COLLAPSING)\n        .removeClass(ClassName.COLLAPSE)\n        .removeClass(ClassName.SHOW);\n\n      this.setTransitioning(true);\n\n      const complete = () => {\n        // check if disposed\n        if (!this.config || !this.element) {\n          return;\n        }\n        if (this.transitioning && this.config.onTransitionEnd) {\n          this.config.onTransitionEnd();\n        }\n\n        this.setTransitioning(false);\n        elem.trigger(Event.HIDDEN);\n\n        elem\n          .removeClass(ClassName.COLLAPSING)\n          .addClass(ClassName.COLLAPSE);\n      };\n\n      if (elem.height() === 0 || elem.css('display') === 'none') {\n        complete();\n      } else {\n        elem\n          .height(0)\n          .one(TRANSITION_END, complete)\n          .emulateTransitionEnd(TRANSITION_DURATION);\n      }\n    }\n\n    setTransitioning(isTransitioning) {\n      this.transitioning = isTransitioning;\n    }\n\n    dispose() {\n      $.removeData(this.element, DATA_KEY);\n\n      $(this.element)\n        .find(this.config.parentTrigger)\n        // .has(this.config.subMenu)\n        .children(this.config.triggerElement)\n        .off(Event.CLICK_DATA_API);\n\n      this.transitioning = null;\n      this.config = null;\n      this.element = null;\n    }\n\n    static jQueryInterface(config) {\n      // eslint-disable-next-line func-names\n      return this.each(function () {\n        const $this = $(this);\n        let data = $this.data(DATA_KEY);\n        const conf = {\n          ...Default,\n          ...$this.data(),\n          ...(typeof config === 'object' && config ? config : {}),\n        };\n\n        if (!data) {\n          data = new MetisMenu(this, conf);\n          $this.data(DATA_KEY, data);\n        }\n\n        if (typeof config === 'string') {\n          if (data[config] === undefined) {\n            throw new Error(`No method named \"${config}\"`);\n          }\n          data[config]();\n        }\n      });\n    }\n  }\n  /**\n   * ------------------------------------------------------------------------\n   * jQuery\n   * ------------------------------------------------------------------------\n   */\n\n  $.fn[NAME] = MetisMenu.jQueryInterface; // eslint-disable-line no-param-reassign\n  $.fn[NAME].Constructor = MetisMenu; // eslint-disable-line no-param-reassign\n  $.fn[NAME].noConflict = () => {\n    // eslint-disable-line no-param-reassign\n    $.fn[NAME] = JQUERY_NO_CONFLICT; // eslint-disable-line no-param-reassign\n    return MetisMenu.jQueryInterface;\n  };\n\n  return skylark.attach(\"intg.MetisMenu\", MetisMenu);\n\n});\n\n\n"]}